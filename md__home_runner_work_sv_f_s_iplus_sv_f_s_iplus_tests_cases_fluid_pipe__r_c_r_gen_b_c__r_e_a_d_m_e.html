<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>svFSIplus: &lt;strong&gt;Problem Description&lt;/strong&gt;</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">svFSIplus
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title"><b>Problem Description</b> </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Solve the same problem as in <a href="../pipe_RCR_3D">fluid/pipe_RCR_3d</a>. Instead of using the RCR within the <code>svFSIplus</code> solver, this example demonstrates how to set up RCR boundary condition in a more generalized framework using sv0DSolver.</p>
<h1><a class="anchor" id="autotoc_md115"></a>
Introduction</h1>
<p>Both sv0DSolver and genBC (see <a href="../pipe_RCR_genBC">pipe_RCR_genBC</a>) provide a framework to programmatically define custom inflow and outflow boundary conditions for a CFD simulation. The framework allows users to create an arbitrary lumped parameter network (LPN, or 0D model) layout suitable for their application. Some common examples include a lumped parameter heart model that models contraction of the heart chambers to use as an inlet boundary condition, sophisticated models of the downstream circulation for various areas of the body such as the legs and upper body, or a closed-loop formulation where all outflow of the SimVascular model returns back to the inflow after passing through the veins, heart, and pulmonary arteries.</p>
<p><b>Essentially, sv0D and genBC are two different implementations of the same functionality, and sv0D is the preferred choice.</b> genBC is a legacy code developed for <a href="https://github.com/SimVascular/svSolver">svSolver</a> and requires direct input of a system of equations. sv0DSolver has pre-defined blocks with associated equations and is more user-friendly. Still, <code>svFSIplus</code> provides backward compatibility for genBC so that svSolver users can migrate to the new solver easily.</p>
<h1><a class="anchor" id="autotoc_md116"></a>
Configuration of genBC</h1>
<p>There are excellent tutorials online that show the users how to set up genBC step-by-step. SimVascular website: <a href="https://simvascular.github.io/docsGenBC.html">https://simvascular.github.io/docsGenBC.html</a> Youtube tutorial: <a href="https://www.youtube.com/watch?v=znfV0XLV79s&ab_channel=SimVascular">https://www.youtube.com/watch?v=znfV0XLV79s&amp;ab_channel=SimVascular</a></p>
<p><b>We strongly encourage users to go through these tutorials first to become familiar with the concept and the workflow.</b></p>
<p>The input file <a href="./svFSI_genBC.inp">svFSI_genBC.inp</a> follows the master input file as a template. Some specific input options are discussed below:</p>
<div class="fragment"><div class="line">&lt;Couple_to_genBC type=&quot;SI&quot;&gt;</div>
<div class="line">   &lt;ZeroD_code_file_path&gt; genBC/genBC.exe &lt;/ZeroD_code_file_path&gt;</div>
<div class="line">&lt;/Couple_to_genBC&gt;</div>
</div><!-- fragment --><p>This tells the solver that the 0d models will be calculated through genBC. Options to couple 0D codes with svFSI are <code>N</code>: none; <code>I</code>: implicit; <code>SI</code>: semi-implicit; <code>E</code>: explicit.</p>
<div class="fragment"><div class="line">&lt;Add_BC name=&quot;lumen_inlet&quot; &gt; </div>
<div class="line">   &lt;Type&gt; Dir &lt;/Type&gt; </div>
<div class="line">   &lt;Time_dependence&gt; Unsteady &lt;/Time_dependence&gt; </div>
<div class="line">   &lt;Temporal_values_file_path&gt; lumen_inlet.flw&lt;/Temporal_values_file_path&gt; </div>
<div class="line">   &lt;Zero_out_perimeter&gt; true &lt;/Zero_out_perimeter&gt; </div>
<div class="line">   &lt;Impose_flux&gt; true &lt;/Impose_flux&gt; </div>
<div class="line">&lt;/Add_BC&gt; </div>
<div class="line"> </div>
<div class="line">&lt;Add_BC name=&quot;lumen_outlet&quot; &gt; </div>
<div class="line">   &lt;Type&gt; Neu &lt;/Type&gt; </div>
<div class="line">   &lt;Time_dependence&gt; Coupled &lt;/Time_dependence&gt; </div>
<div class="line">&lt;/Add_BC&gt; </div>
</div><!-- fragment --><p>In this example, we use the LPN for just the outlet RCR boundary condition and use a file to specify the inlet flow conditions.</p>
<h2><a class="anchor" id="autotoc_md117"></a>
Matching faces between 3D and 0D</h2>
<p>In genBC, user has to provide face tags in the USER.f file and make sure that these tags match the ones in solver.inp file for svSolver. In essence, when using genBC, it is the user's responsibility to match both the bcs provided in the svPresolver and svSolver files, and also in the USER.f file.</p>
<h2><a class="anchor" id="autotoc_md118"></a>
Implementation of 0D model</h2>
<p>The 0D model or LPN is defined in USER.f. Here are the boundary conditions implemented in genBC:</p>
<div class="fragment"><div class="line"><span class="comment">!     BC</span></div>
<div class="line">      rp = 121d0</div>
<div class="line">      c  = 1.5d-4</div>
<div class="line">      rd = 1212d0</div>
<div class="line"> </div>
<div class="line">      f(1) = (1d0/c) * (q(1) - x(1)/rd)</div>
<div class="line">      offset(1) = q(1)*rp</div>
<div class="line"> </div>
<div class="line"><span class="comment">!     Assign the additional parameters to be printed       </span></div>
<div class="line">      xprint(1)=t</div>
<div class="line">      xprint(2)= q(1)</div>
<div class="line">      xprint(3) = offset(1)</div>
</div><!-- fragment --><p>Here, we specify the RCR boundary used at the outlet, with the corresponding formulation defined in <code>f(1)</code>.</p>
<p>In genBC, <code>Q(:)</code> and <code>P(:)</code> are defined as flow rates of Neumann faces and pressure of Dirichlet faces, respectively. It is the user's responsibility to carefully match the component <code>Q(i)</code> to the corresponding face, which can be error-prone when the number of faces are large. On the other hand, in cplBC, <code>Q(i)</code> simply represents the flow rate on the ith face.</p>
<h2><a class="anchor" id="autotoc_md119"></a>
Outputs from 0D model</h2>
<p>genBC writes out the results in <code>AllData</code> in the current folder, and it includes all the unknowns and the user-specified outputs. In this case, the order will be</p>
<div class="fragment"><div class="line">outlet_pressure  time  outlet_flux  offset(1)</div>
</div><!-- fragment --><p>Here, the last three are user-defined outputs.</p>
<h2><a class="anchor" id="autotoc_md120"></a>
Initial conditions</h2>
<p>In genBC, the initial conditions are specified in USER.f through variable <code>tZeroX</code>. Hence, user needs to recompile genBC every time it changes. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
